-- Task 2.1
CREATE TABLE LOAN(
LOAN_NO CHAR(5) PRIMARY KEY,
AMOUNT DECIMAL(12,2) NOT NULL
);

-- TASK 2.2
INSERT INTO LOAN VALUES ('L-201', 10000.00),
('L-202', 20000.00),
('L-203', 15000.00);

CREATE TABLE BORROWER (
CUSTOMER_NO CHAR (5) ,
LOAN_NO CHAR (5) ,
PRIMARY KEY (CUSTOMER_NO , LOAN_NO) ,
FOREIGN KEY (CUSTOMER_NO) REFERENCES CUSTOMER (CUSTOMER_NO) ,
FOREIGN KEY (LOAN_NO) REFERENCES LOAN (LOAN_NO)
) ;

INSERT INTO BORROWER VALUES ('C-101', 'L-201'),
('C-102', 'L-202'),
('C-103', 'L-203');


-- TASK 2.3
SELECT CUSTOMER.CUSTOMER_NO, CUSTOMER.CUSTOMER_NAME
FROM CUSTOMER
INNER JOIN DEPOSITOR_INFO ON CUSTOMER.CUSTOMER_NO = DEPOSITOR_INFO.C_NO
INNER JOIN BORROWER ON CUSTOMER.CUSTOMER_NO = BORROWER.CUSTOMER_NO;


-- TASK 2.4
SELECT CUSTOMER.CUSTOMER_NO, CUSTOMER.CUSTOMER_NAME
FROM CUSTOMER
INNER JOIN DEPOSITOR_INFO ON CUSTOMER.CUSTOMER_NO = DEPOSITOR_INFO.C_NO
LEFT JOIN BORROWER ON CUSTOMER.CUSTOMER_NO = BORROWER.CUSTOMER_NO
WHERE BORROWER.LOAN_NO IS NULL;


 -- OR,
 SELECT CUSTOMER.CUSTOMER_NO, CUSTOMER.CUSTOMER_NAME
FROM CUSTOMER
INNER JOIN DEPOSITOR_INFO ON CUSTOMER.CUSTOMER_NO = DEPOSITOR_INFO.C_NO
WHERE CUSTOMER.CUSTOMER_NO NOT IN (
    SELECT BORROWER.CUSTOMER_NO
    FROM BORROWER
);


-- TASK 2.5
UPDATE ACCOUNT
SET BALANCE = BALANCE * 1.05
WHERE BALANCE < 10000;